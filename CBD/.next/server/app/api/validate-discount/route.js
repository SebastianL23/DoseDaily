(()=>{var e={};e.id=888,e.ids=[888],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},5306:(e,s,t)=>{"use strict";t.d(s,{N:()=>r});let r=(0,t(6291).UU)("https://noupoembruywnsjjezmc.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5vdXBvZW1icnV5d25zamplem1jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY1NTQyMzcsImV4cCI6MjA2MjEzMDIzN30.ZUyHNO2-aGGkEuxFyYX9V1uisxB64hLisx8Tnhc1PZQ")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},24467:()=>{},27910:e=>{"use strict";e.exports=require("stream")},28956:(e,s,t)=>{"use strict";t.r(s),t.d(s,{patchFetch:()=>v,routeModule:()=>c,serverHooks:()=>x,workAsyncStorage:()=>p,workUnitAsyncStorage:()=>l});var r={};t.r(r),t.d(r,{POST:()=>d});var i=t(43007),o=t(44360),u=t(98343),a=t(28142),n=t(5306);async function d(e){try{let{code:s,email:t}=await e.json();if(console.log("Validate Discount - Received values:",{code:s,email:t}),!s)return a.NextResponse.json({valid:!1,message:"Discount code is required"},{status:400});let{data:r,error:i}=await n.N.from("discount_codes").select("*").eq("code",s).eq("email",t).single();if(console.log("Validate Discount - Query result:",{discountCode:r,error:i,used:r?.used,code:r?.code,email:r?.email}),i||!r)return console.error("Discount code error:",i),a.NextResponse.json({valid:!1,message:"Invalid discount code"},{status:400});if(new Date>new Date(r.expires_at))return a.NextResponse.json({valid:!1,message:"Discount code has expired"},{status:400});if(r.used)return console.log("Code already used:",{used:r.used,used_at:r.used_at}),a.NextResponse.json({valid:!1,message:"This discount code has already been used"},{status:400});return a.NextResponse.json({valid:!0,discount:{code:r.code,email:r.email,expires_at:r.expires_at,discount_type:r.discount_type,discount_value:r.discount_value,used:r.used}})}catch(e){return console.error("Error validating discount code:",e),a.NextResponse.json({valid:!1,message:"Error validating discount code"},{status:500})}}let c=new i.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/validate-discount/route",pathname:"/api/validate-discount",filename:"route",bundlePath:"app/api/validate-discount/route"},resolvedPagePath:"/Users/sebastianlourenco/Desktop/CBD/CBD/app/api/validate-discount/route.ts",nextConfigOutput:"",userland:r}),{workAsyncStorage:p,workUnitAsyncStorage:l,serverHooks:x}=c;function v(){return(0,u.patchFetch)({workAsyncStorage:p,workUnitAsyncStorage:l})}},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},34631:e=>{"use strict";e.exports=require("tls")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},61419:()=>{},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[535,38,291],()=>t(28956));module.exports=r})();